var Wt=Object.defineProperty,Qt=Object.defineProperties;var Zt=Object.getOwnPropertyDescriptors;var We=Object.getOwnPropertySymbols;var en=Object.prototype.hasOwnProperty,tn=Object.prototype.propertyIsEnumerable;var Qe=(e,t,s)=>t in e?Wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,me=(e,t)=>{for(var s in t||(t={}))en.call(t,s)&&Qe(e,s,t[s]);if(We)for(var s of We(t))tn.call(t,s)&&Qe(e,s,t[s]);return e},Ve=(e,t)=>Qt(e,Zt(t));import{C as nn,e as sn,d as on,a as an,c as un,u as ln,b as rn,E as G,f as A,g as R,h as he,r as T,w as Z,i as Ae,j as Ze,k as Ne,l as et,m as tt,n as nt,o as st,p as ot,q as cn,v as $e,s as p,t as F,x as m,y as f,z as i,A as ie,B as K,D as S,F as E,G as ne,H as re,I as L,J as M,K as ce,L as dn,M as se,N as r,O as oe,P as ae,Q as _n,R as X,S as pn,T as ue,U as Ee,V as ve,W as at,X as de,Y as ut,Z as lt,_ as it,$ as rt,a0 as ct,a1 as ye,a2 as ke,a3 as dt,a4 as _t,a5 as mn,a6 as fn,a7 as gn,a8 as hn,a9 as En,aa as vn,ab as Fn,ac as Dn,ad as pt,ae as In,af as Cn,ag as Sn}from"./vendor.3629949c.js";const bn=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const a of u.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(o){if(o.ep)return;o.ep=!0;const u=s(o);fetch(o.href,u)}};bn();const An="modulepreload",mt={},$n="./",ft=function(t,s){return!s||s.length===0?t():Promise.all(s.map(n=>{if(n=`${$n}${n}`,n in mt)return;mt[n]=!0;const o=n.endsWith(".css"),u=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${u}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":An,o||(a.as="script",a.crossOrigin=""),a.href=n,document.head.appendChild(a),o)return new Promise((l,d)=>{a.addEventListener("load",l),a.addEventListener("error",d)})})).then(()=>t())},we="PICX_",Ge=`${we}CONFIG`,gt=`${we}UPLOADED`,ht=`${we}MANAGEMENT_MULTI`,Et=`${we}SETTINGS`,Fe=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),yn=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},kn=e=>{if(e==="/")return[];const t=e.split("/"),s=[];let n="";return t.forEach((o,u)=>{n+=`${u>0?"/":""}${o}`,s.unshift(n)}),s};function vt(e,t,s){var n;return e?t.length===s?e:vt((n=e.childrenDirs)==null?void 0:n.find(o=>o.dir===t[s]),t,++s):null}const Le=(e,t)=>{if(e==="/")return t;const s=e.split("/");return vt(t,s,0)},Ue=(e,t,s)=>{var n;return s==="dir"?(n=t.childrenDirs)==null?void 0:n.filter(o=>o.type==="dir"):s==="image"?t.imageList.filter(o=>o.type==="image"):[]},wn=(e,t)=>{e==="/"&&t.dispatch("SET_USER_CONFIG_INFO",{dirMode:"rootDir",needPersist:!1})},Ln=()=>{const e=localStorage.getItem(ht);return e?JSON.parse(e):Fe("/","/")},Un={state:{name:"dirImageListModule",dirObject:Ln()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},s){if(s==="/")return;const n=(l,d,c)=>l?(l.childrenDirs.some(g=>g.dir===d)||l.childrenDirs.push(Fe(d,c)),l.childrenDirs.find(g=>g.dir===d)||Fe(d,c)):Fe(d,c),o=s.split("/");let u="",a=e.dirObject;for(let l=0,d=o.length;l<d;l++){const c=o[l];u+=`${l>0?"/":""}${c}`,a=n(a,c,u),l===0&&t("USER_CONFIG_INFO_ADD_DIR",c)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},s){if(s==="/")return;const n=(a,l,d)=>{if(l==="/")return e.dirObject;const c=a.childrenDirs.find(_=>_.dir===l);if(!c)return a;if(d){const _=a.childrenDirs.findIndex(g=>g.dir===l);_!==-1&&a.childrenDirs.splice(_,1)}return c},o=s.split("/");let u=e.dirObject;o.forEach((a,l)=>{u=n(u,a,l===o.length-1),l===0&&t("USER_CONFIG_INFO_REMOVE_DIR",a)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},s){const n=(u,a,l,d=!1)=>{var _;if(!u)return e.dirObject;const c=(_=u.childrenDirs)==null?void 0:_.find(g=>g.dir===a);return c?(d&&!c.imageList.some(g=>g.name===l.name)&&c.imageList.push(l),c):e.dirObject};let o=e.dirObject;if(s.dir==="/")o.imageList.some(u=>u.name===s.name)||o.imageList.push(s);else{const u=s.dir.split("/");u.forEach((a,l)=>{o=n(o,a,s,l===u.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},s){const n=(c,_)=>{if(c.length){const g=c.findIndex(D=>D.uuid===_);g!==-1&&c.splice(g,1)}},o=(c,_,g,D)=>{if(!c)return e.dirObject;const b=c.childrenDirs.find(O=>O.dir===_);return b?(b.dir===_&&D&&n(b.imageList,g.uuid),b):e.dirObject},{dir:u,uuid:a}=s;if(u==="/"){n(e.dirObject.imageList,a),t("DIR_IMAGE_LIST_PERSIST");return}const l=u.split("/");let d=e.dirObject;l.forEach((c,_)=>{d=o(d,c,s,_===l.length-1),!d.imageList.length&&!d.childrenDirs.length&&kn(d.dirPath).forEach(D=>{const b=Le(D,e.dirObject);if(b&&!b.imageList.length&&!b.childrenDirs.length){const{dirPath:O}=yn(D);t("SET_USER_CONFIG_INFO",{selectedDir:O}),t("DIR_IMAGE_LIST_REMOVE_DIR",D)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},s){let n=e.dirObject;if(s==="/"){n.imageList=[],n.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const o=(a,l,d)=>{var _;if(!a)return e.dirObject;const c=(_=a.childrenDirs)==null?void 0:_.find(g=>g.dir===l);return c?(d&&(c.imageList=[],c.childrenDirs=[]),c):e.dirObject},u=s.split("/");u.forEach((a,l)=>{n=o(n,a,l===u.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(ht,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e}){e.dirObject=Fe("/","/")}},getters:{getDirObject:e=>e.dirObject}},Bn={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},t){e.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:t,base64Url:s}){e.curImgUuid=t,e.curImgBase64Url=s},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},t){if(e.list.length>0){const s=e.list.findIndex(n=>n.uuid===t);if(s!==-1&&e.list.splice(s,1),e.list.length===0)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===t){const n=e.list[0];e.curImgBase64Url=n.imgData.base64Url,e.curImgUuid=n.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const t=e.list.filter(s=>s.uploadStatus.progress!==100);t.length>0&&(e.list=t,e.uploadedNumber=0,e.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},Tn=()=>{const e=sessionStorage.getItem(gt);return e?JSON.parse(e):[]},On={state:{uploadedImageList:Tn()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:t},s){e.uploadedImageList.unshift(s),t("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:t},s){if(e.uploadedImageList.length>0){const n=e.uploadedImageList.findIndex(o=>o.uuid===s);n!==-1&&(e.uploadedImageList.splice(n,1),t("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem(gt,JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e}){e.uploadedImageList=[]}},getters:{getUploadedImageList:e=>e.uploadedImageList}};var _e;(function(e){e.newBranch="newBranch",e.reposBranch="reposBranch"})(_e||(_e={}));const Ft=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},Dt=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Mn=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},It=e=>{for(const t in e)switch(Ft(e[t])){case"object":It(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},ze=(e,t)=>{for(const s in t)Ft(t[s])!=="object"?e&&(e[s]=t[s]):ze(e[s],t[s])};var q;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.reposDir="reposDir"})(q||(q={}));class Be{static zerofill(t){return t<10?`0${t}`:t}static getYyyyMmDd(t=Date.now()){const s=new Date(t),n=s.getFullYear(),o=s.getMonth()+1,u=s.getDate();return`${n}${this.zerofill(o)}${this.zerofill(u)}`}static formatTimestamp(t=Date.now()){const s=new Date(t),n=s.getFullYear(),o=s.getMonth()+1,u=s.getDate(),a=s.getHours(),l=s.getMinutes(),d=s.getSeconds();return`${n}-${this.zerofill(o)}-${this.zerofill(u)} ${this.zerofill(a)}:${this.zerofill(l)}:${this.zerofill(d)}`}}const Ct=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],branchMode:_e.reposBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:q.reposDir,dirList:[],loggingStatus:!1,selectedDirList:[]},t=localStorage.getItem(Ge);return t&&(ze(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===q.autoDir&&(e.selectedDir=Be.getYyyyMmDd())),e},St=e=>{const{selectedDir:t,selectedBranch:s,dirMode:n}=e.userConfigInfo;if(n==="newDir"){const o=t.split("");let u=0,a="";for(let l=0;l<o.length&&((o[l]===" "||o[l]==="."||o[l]==="\u3001")&&(o[l]="-"),o[l]==="/"&&(u+=1),!(u>=3));l++)a+=o[l];e.userConfigInfo.selectedDir=a}e.userConfigInfo.selectedBranch=s.replace(/\s+/g,"-")},Rn={state:{userConfigInfo:Ct()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Ct()},SET_USER_CONFIG_INFO({state:e,dispatch:t},s,n=!0){for(const o in s)e.userConfigInfo.hasOwnProperty(o)?e.userConfigInfo[o]=s[o]:o==="needPersist"&&(n=!1);!n||t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},s){e.userConfigInfo.dirList.some(n=>n.value===s)||(e.userConfigInfo.dirList.push({label:s,value:s}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},s){const{dirList:n}=e.userConfigInfo;if(n.some(o=>o.value===s)){const o=n.findIndex(u=>u.value===s);n.splice(o,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){St(e),localStorage.setItem(Ge,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_NOT_PERSIST({state:e}){St(e)},USER_CONFIG_INFO_LOGOUT({state:e}){It(e.userConfigInfo)}},getters:{getUserLoggingStatus:e=>e.userConfigInfo.loggingStatus,getUserConfigInfo:e=>e.userConfigInfo}},xn={state:{imageViewer:{imgInfo:null,isShow:!1}},mutations:{IMAGE_VIEWER(e,{imgInfo:t,isShow:s}){e.imageViewer.imgInfo=t,e.imageViewer.isShow=s},IMAGE_VIEWER_LOGOUT(e){e.imageViewer.isShow=!1,e.imageViewer.imgInfo=null}},actions:{},getters:{getImageViewer:e=>e.imageViewer}},Pn={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:s,checked:n}=t;n&&e.imgCardArr.forEach(o=>{o.uuid===s&&(o.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},Vn={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},actions:{},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},Nn={state:{uploadSettings:{isSetMaxSize:!0,imageMaxSize:30*1024}},mutations:{UPLOAD_SETTINGS_LOGOUT(e){e.uploadSettings.isSetMaxSize=!0,e.uploadSettings.imageMaxSize=50*1024}},actions:{},getters:{getUploadSettings:e=>e.uploadSettings}};var Te;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(Te||(Te={}));const Gn=async(e,t)=>new nn(e,{encoderState:{type:t,options:sn[t].meta.defaultOptions},processorState:on,preprocessorState:an}).process(),He={defaultHash:!0,defaultMarkdown:!1,defaultPrefix:!1,prefixName:"",isCompress:!0,compressEncoder:Te.webP,themeMode:"light",autoLightThemeTime:["08:00","19:00"],elementPlusSize:"default"},zn=()=>{const e=Mn(Et);return e&&ze(He,e),He},Hn={state:{userSettings:zn()},actions:{SET_USER_SETTINGS({state:e},t){for(const s in t)e.userSettings.hasOwnProperty(s)&&(e.userSettings[s]=t[s])},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(Et,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=He}},getters:{getUserSettings:e=>e.userSettings}},x=un({modules:{dirImageListModule:Un,toUploadImageModule:Bn,uploadedImageListModule:On,userConfigInfoModule:Rn,imageViewerModule:xn,imageCardModule:Pn,uploadAreaActiveModule:Vn,uploadSettingsModule:Nn,userSettingsModule:Hn},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),t("IMAGE_VIEWER_LOGOUT"),t("UPLOAD_AREA_ACTIVE_LOGOUT"),t("UPLOAD_SETTINGS_LOGOUT"),e("USER_SETTINGS_LOGOUT"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),bt=Symbol("vuex-store");function H(){return ln(bt)}const jn="https://api.github.com",W=rn.create({baseURL:jn,timeout:3e5});W.defaults.headers["Content-Type"]="application/json";W.interceptors.request.use(e=>{const t=localStorage.getItem(Ge);if(t){const{token:s}=JSON.parse(t);s&&(e.headers.Authorization=`token ${s}`)}return e},e=>Promise.reject(e));W.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data){const t=e.response.status,s=e.response.data.message;G.error(`Code: ${t}, Message: ${s}`),console.error("[PicX Error]",e.response)}else G.error(`${e}`);return e.response});const De=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},je=e=>{const t=e.lastIndexOf(".");return e.substr(t+1,e.length)},At=e=>/(png|jpg|gif|jpeg|webp|avif|svg\+xml|image\/x-icon)$/.test(e),Oe=e=>Number((e/1024).toFixed(2)),$t=e=>e?{name:De(e),hash:Dt(),suffix:je(e)}:{name:"",hash:"",suffix:""};var P;(function(e){e.gh="gh",e.md_gh="md_gh",e.cdn="cdn",e.md_cdn="md_cdn"})(P||(P={}));const le=(e,t,s)=>{const n=`https://cdn.jsdelivr.net/gh/${s.owner}/${s.selectedRepos}@${s.selectedBranch}/${t.path}`,o=decodeURI(t.download_url);switch(e){case P.gh:return o;case P.md_gh:return`![${De(t.name)}](${o})`;case P.cdn:return n;case P.md_cdn:return`![${De(t.name)}](${n})`}},Me=A(()=>x.getters.getUserConfigInfo).value;function Xn(e,t){return{type:"image",uuid:Dt(),dir:t,name:e.name,path:e.path,sha:e.sha,github_url:le(P.gh,e,Me),cdn_url:le(P.cdn,e,Me),md_gh_url:le(P.md_gh,e,Me),md_cdn_url:le(P.md_cdn,e,Me),deleting:!1,is_transform_md:!1,size:e.size,checked:!1}}const fe=A(()=>x.getters.getUserConfigInfo).value,yt=(e="")=>new Promise(t=>{W.get(`/repos/${fe.owner}/${fe.selectedRepos}/contents/${e}`,{params:{ref:fe.selectedBranch}}).then(s=>{s&&s.status===200&&s.data.length>0?t(s.data.filter(n=>n.type==="dir").map(n=>({value:n.name,label:n.name}))):t(null)}).catch(()=>{t(null)})}),Re=(e="")=>new Promise(t=>{W.get(`/repos/${fe.owner}/${fe.selectedRepos}/contents/${e}`,{params:{ref:fe.selectedBranch}}).then(s=>{s&&s.status===200&&s.data.length>0?(s.data.filter(n=>n.type==="dir").forEach(n=>x.dispatch("DIR_IMAGE_LIST_ADD_DIR",n.path)),setTimeout(()=>{s.data.filter(n=>n.type==="file"&&At(je(n.name))).forEach(n=>x.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",Xn(n,e)))},100),t(!0)):t(null)}).catch(()=>{t(null)})});var V=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s};const Yn={class:"page-container config-page-container"},Jn=L(" \u786E\u8BA4 Token ");const Kn=L("\u65B0\u5EFA\u76EE\u5F55"),qn=L("\u6839\u76EE\u5F55"),Wn=L("\u81EA\u52A8\u76EE\u5F55"),Qn=L(" \u91CD\u7F6E "),Zn=L(" \u5B8C\u6210\u914D\u7F6E "),es=R({__name:"config",setup(e){const t=he(),s=H(),n=A(()=>s.getters.getUserConfigInfo).value,o=A(()=>s.getters.getUserConfigInfo).value,u=A(()=>s.getters.getUserSettings).value,a=T(!1),l=T(!1),d=T(!1),c=A(()=>u.elementPlusSize==="small"?"top":"right"),_=T("elCascaderKey");function g(){s.dispatch("USER_CONFIG_INFO_PERSIST")}function D(C){n.loggingStatus=!0,n.owner=C.data.login,n.name=C.data.name,n.email=C.data.email,n.avatarUrl=C.data.avatar_url,g()}function b(C){W.get(C,{params:{type:"public",sort:"created",per_page:100}}).then(v=>{if(console.log("[getReposList] ",v),v.status===200&&v.data.length>0){n.reposList=[];for(const w of v.data)!w.fork&&!w.private&&n.reposList.push({value:w.name,label:w.name,desc:w.description});a.value=!1,g()}})}async function O(){l.value=!0,n.dirList=await yt(),g(),l.value=!1}function B(C){switch(C){case q.rootDir:n.selectedDir="/";break;case q.autoDir:n.selectedDir=Be.getYyyyMmDd();break;case q.newDir:n.selectedDir="xxx";break;case q.reposDir:const{dirList:v}=n;v.length?n.selectedDir=v[0].value:n.selectedDir="";break;default:n.selectedDir="/";break}g()}function h(C){d.value=!0,W.get(`/repos/${n.owner}/${C}/branches`).then(v=>{if(console.log("[getBranchList] ",v),v&&v.status===200){if(d.value=!1,v.data.length>0){for(const w of v.data)n.branchList.push({value:w.name,label:w.name});n.branchList.reverse(),n.selectedBranch=n.branchList[0].value,n.branchMode=_e.reposBranch,O()}else n.selectedBranch="master",n.branchMode=_e.newBranch;B(n.dirMode),g()}})}function k(){n.token?(a.value=!0,W.get("/user",{headers:{Authorization:`token ${n.token}`}}).then(C=>{console.log("[getUserInfo] ",C),C&&C.status===200?(D(C),b(C.data.repos_url)):a.value=!1})):G.warning("Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01")}function $(C){n.branchList=[],n.dirList=[],h(C),g()}async function I(C){n.selectedBranch=C,await O(),_.value=n.selectedBranch,n.selectedDir=n.dirList[0].value,n.selectedDirList=[n.selectedDir],g()}function U(C){const v=n.selectedBranch,w=n.branchList[0].value;switch(C){case _e.newBranch:n.selectedBranch="xxx",n.dirMode=q.newDir,n.selectedDir="xxx";break;case _e.reposBranch:v!==w&&(n.selectedBranch=w,O());break;default:n.selectedBranch="";break}g()}function j(){a.value=!1,l.value=!1,s.dispatch("LOGOUT")}function Y(){const{selectedDir:C,dirMode:v}=n;let w="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(C===""){switch(v){case q.newDir:w="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case q.reposDir:w=`\u8BF7\u9009\u62E9 ${n.selectedRepos} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:w="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}G.warning(w)}else t.push("/upload")}const Q={lazy:!0,checkStrictly:!0,async lazyLoad(C,v){const{level:w,pathLabels:N}=C;let z;w===0?z=n.dirList:z=await yt(N.join("/")),v(z?z.map(te=>({value:te.value,label:te.label,leaf:w>=2})):[])}};function J(C){n.selectedDirList=C,n.selectedDir=C.join("/"),g()}return Z(()=>o,C=>{C||(a.value=!1,l.value=!1)}),(C,v)=>{const w=Ae,N=Ze,z=Ne,te=et,Ke=tt,qe=nt,Se=st,be=ce,Kt=ot,qt=cn,xe=$e;return p(),F("div",Yn,[m(te,{"label-width":"70rem","label-position":i(c),class:"config-form"},{default:f(()=>[m(N,{label:"Token"},{default:f(()=>[m(w,{modelValue:i(n).token,"onUpdate:modelValue":v[0]||(v[0]=y=>i(n).token=y),clearable:"",autofocus:!i(n).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),m(N,{class:"operation"},{default:f(()=>[m(z,{plain:"",type:"primary","native-type":"submit",onClick:v[1]||(v[1]=ie(y=>k(),["prevent"]))},{default:f(()=>[Jn]),_:1})]),_:1})]),_:1},8,["label-position"]),i(n).token?K((p(),S(te,{key:0,"label-width":"70rem","label-position":i(c),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:f(()=>[i(n).owner?(p(),S(N,{key:0,label:"\u7528\u6237\u540D"},{default:f(()=>[m(w,{modelValue:i(n).owner,"onUpdate:modelValue":v[2]||(v[2]=y=>i(n).owner=y),readonly:""},null,8,["modelValue"])]),_:1})):E("",!0),i(n).email?(p(),S(N,{key:1,label:"\u90AE\u7BB1"},{default:f(()=>[m(w,{modelValue:i(n).email,"onUpdate:modelValue":v[3]||(v[3]=y=>i(n).email=y),readonly:""},null,8,["modelValue"])]),_:1})):E("",!0),i(n).reposList.length?(p(),S(N,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:f(()=>[m(qe,{modelValue:i(n).selectedRepos,"onUpdate:modelValue":v[4]||(v[4]=y=>i(n).selectedRepos=y),filterable:"",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:$},{default:f(()=>[(p(!0),F(ne,null,re(i(n).reposList,(y,Pe)=>(p(),S(Ke,{key:Pe,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0)]),_:1},8,["label-position"])),[[xe,a.value]]):E("",!0),i(n).selectedRepos&&i(n).branchList.length?K((p(),S(te,{key:1,"label-width":"70rem","label-position":i(c),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:f(()=>[(i(n).selectedRepos,E("",!0)),i(n).branchList.length>1&&i(n).branchMode==="reposBranch"?(p(),S(N,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:f(()=>[m(qe,{modelValue:i(n).selectedBranch,"onUpdate:modelValue":v[6]||(v[6]=y=>i(n).selectedBranch=y),filterable:"",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:I},{default:f(()=>[(p(!0),F(ne,null,re(i(n).branchList,(y,Pe)=>(p(),S(Ke,{key:Pe,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),i(n).branchMode==="newBranch"?(p(),S(N,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:f(()=>[m(w,{modelValue:i(n).selectedBranch,"onUpdate:modelValue":v[7]||(v[7]=y=>i(n).selectedBranch=y),onInput:v[8]||(v[8]=y=>g()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F..."},null,8,["modelValue"])]),_:1})):E("",!0)]),_:1},8,["label-position"])),[[xe,d.value]]):E("",!0),i(n).selectedBranch?K((p(),S(te,{key:2,"label-width":"70rem","label-position":i(c),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:f(()=>[i(n).selectedBranch?(p(),S(N,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:f(()=>[m(Kt,{modelValue:i(n).dirMode,"onUpdate:modelValue":v[9]||(v[9]=y=>i(n).dirMode=y),onChange:B},{default:f(()=>[m(be,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[m(Se,{label:"newDir"},{default:f(()=>[Kn]),_:1})]),_:1}),m(be,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+i(n).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:f(()=>[m(Se,{label:"rootDir"},{default:f(()=>[qn]),_:1})]),_:1},8,["content"]),m(be,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[m(Se,{label:"autoDir"},{default:f(()=>[Wn]),_:1})]),_:1}),i(n).dirList.length&&i(n).branchMode!=="newBranch"?(p(),S(be,{key:0,content:"\u9009\u62E9 "+i(n).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[m(Se,{label:"reposDir"},{default:f(()=>[L(" \u9009\u62E9 "+M(i(n).selectedRepos)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):E("",!0)]),_:1},8,["modelValue"])]),_:1})):E("",!0),i(n).dirMode==="autoDir"?(p(),S(N,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:f(()=>[m(w,{modelValue:i(n).selectedDir,"onUpdate:modelValue":v[10]||(v[10]=y=>i(n).selectedDir=y),readonly:""},null,8,["modelValue"])]),_:1})):E("",!0),i(n).dirMode==="rootDir"?(p(),S(N,{key:2,label:"\u6839\u76EE\u5F55"},{default:f(()=>[m(w,{modelValue:i(n).selectedDir,"onUpdate:modelValue":v[11]||(v[11]=y=>i(n).selectedDir=y),readonly:""},null,8,["modelValue"])]),_:1})):E("",!0),i(n).dirMode==="newDir"?(p(),S(N,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:f(()=>[m(w,{modelValue:i(n).selectedDir,"onUpdate:modelValue":v[12]||(v[12]=y=>i(n).selectedDir=y),onInput:v[13]||(v[13]=y=>g()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):E("",!0),i(n).dirList.length&&i(n).dirMode==="reposDir"&&i(n).branchMode!=="newBranch"?(p(),S(N,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:f(()=>[(p(),S(qt,{style:{width:"100%"},props:Q,key:_.value,modelValue:i(n).selectedDirList,"onUpdate:modelValue":v[14]||(v[14]=y=>i(n).selectedDirList=y),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:"",onChange:J},null,8,["modelValue"]))]),_:1})):E("",!0)]),_:1},8,["label-position"])),[[xe,l.value]]):E("",!0),m(te,{"label-width":"70rem","label-position":i(c)},{default:f(()=>[m(N,{class:"operation"},{default:f(()=>[i(n).owner?(p(),S(z,{key:0,plain:"",type:"warning",onClick:v[15]||(v[15]=y=>j())},{default:f(()=>[Qn]),_:1})):E("",!0),i(n).selectedRepos?(p(),S(z,{key:1,plain:"",type:"success",onClick:Y},{default:f(()=>[Zn]),_:1})):E("",!0)]),_:1})]),_:1},8,["label-position"])])}}});var ts=V(es,[["__scopeId","data-v-082a0515"]]),kt=()=>({uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",prefixName:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1,isPrefix:!1},externalLink:{github:"",cdn:"",markdown_gh:"",markdown_cdn:""}});function ns(e,t){const s=document.createElement("canvas"),n=s.getContext("2d"),o=new Image;return o.crossOrigin="Anonymous",o.src=e,new Promise(u=>{o.onload=()=>{const{width:a}=o,{height:l}=o;s.width=a,s.height=l,n==null||n.drawImage(o,0,0,a,l);const d=s.toDataURL(`image/${t}`);u(d)}})}function ss(e,t){const s=A(()=>x.getters.getUserSettings).value,n=kt();n.imgData.base64Url=e,n.imgData.base64Content=e.split(",")[1];const{name:o,hash:u,suffix:a}=$t(t.name);return n.uuid=u,n.fileInfo.size=t.size,n.fileInfo.originSize=t.size,n.fileInfo.lastModified=t.lastModified,n.filename.name=o,n.filename.hash=u,n.filename.suffix=a,n.filename.now=s.defaultHash?`${o}.${u}.${a}`:`${o}.${a}`,n.filename.initName=o,n.filename.isHashRename=s.defaultHash,n}const os=(e,t)=>{let s="";return e.selectedDir!=="/"&&(s=`${e.selectedDir}/`),`/repos/${e.owner}/${e.selectedRepos}/contents/${s}${t}`};function wt(e,t){const{selectedBranch:s,email:n,owner:o}=e;t.uploadStatus.uploading=!0;const u={message:"Upload picture via PicX(https://github.com/XPoet/picx)",branch:s,content:t.imgData.base64Content};return n&&(u.committer={name:o,email:n}),new Promise((a,l)=>{W.put(os(e,t.filename.now),u).then(d=>{d&&d.status===201?(as(d,t,e),x.dispatch("TO_UPLOAD_IMAGE_UPLOADED",t.uuid),a(!0)):(t.uploadStatus.uploading=!1,a(!1))}).catch(d=>{l(d)})})}function as(e,t,s){const n=x.getters.getUserSettings;t.uploadStatus.progress=100,t.uploadStatus.uploading=!1,t.externalLink.github=le(P.gh,e.data.content,s),t.externalLink.cdn=le(P.cdn,e.data.content,s),t.externalLink.markdown_gh=le(P.md_gh,e.data.content,s),t.externalLink.markdown_cdn=le(P.md_cdn,e.data.content,s);const o={checked:!1,type:"image",uuid:t.uuid,dir:s.selectedDir,name:e.data.content.name,path:e.data.content.path,sha:e.data.content.sha,github_url:t.externalLink.github,cdn_url:t.externalLink.cdn,md_gh_url:t.externalLink.markdown_gh,md_cdn_url:t.externalLink.markdown_cdn,is_transform_md:n.defaultMarkdown,deleting:!1,size:t.fileInfo.size,lastModified:t.fileInfo.lastModified};t.uploadedImg=o,x.dispatch("UPLOADED_LIST_ADD",o),x.dispatch("DIR_IMAGE_LIST_ADD_DIR",s.selectedDir),x.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)}const Lt=e=>(oe("data-v-a03989aa"),e=e(),ae(),e),us={class:"copy-external-link-box"},ls={key:0,t:"1631782798077",class:"markdown-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2861",width:"26",height:"26"},is=Lt(()=>r("path",{d:"M92 192C42.24 192 0 232.128 0 282.016v459.968C0 791.904 42.24 832 92 832h840C981.76 832 1024 791.872 1024 741.984V282.016C1024 232.16 981.76 192 932 192z m0 64h840c16.512 0 28 12.256 28 26.016v459.968c0 13.76-11.52 26.016-28 26.016H92C75.488 768 64 755.744 64 741.984V282.016c0-13.76 11.52-25.984 28-25.984zM160 352v320h96v-212.992l96 127.008 96-127.04V672h96V352h-96l-96 128-96-128z m544 0v160h-96l144 160 144-160h-96v-160z","p-id":"2862",fill:"#808080"},null,-1)),rs=[is],cs={key:1,t:"1631784688556",class:"markdown-icon active",viewBox:"0 0 1280 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3242",width:"26",height:"26"},ds=Lt(()=>r("path",{d:"M1187.6 118.2H92.4C41.4 118.2 0 159.6 0 210.4v603c0 51 41.4 92.4 92.4 92.4h1095.4c51 0 92.4-41.4 92.2-92.2V210.4c0-50.8-41.4-92.2-92.4-92.2zM677 721.2H554v-240l-123 153.8-123-153.8v240H184.6V302.8h123l123 153.8 123-153.8h123v418.4z m270.6 6.2L763 512H886V302.8h123V512H1132z","p-id":"3243",fill:"#3c3c3c"},null,-1)),_s=[ds],ps={class:"btn-box"},ms=R({__name:"copy-external-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e;A(()=>x.getters.getUserConfigInfo);const s=A(()=>x.getters.getUserSettings),n=T(t.imgObj),o=P;function u(a){let l="",d="";const c=n.value.is_transform_md;switch(a){case P.gh:c?(l=n.value.md_gh_url,d="Markdown \u683C\u5F0F\u7684 GitHub"):(l=n.value.github_url,d="GitHub");break;case P.cdn:c?(l=n.value.md_cdn_url,d="Markdown \u683C\u5F0F\u7684 CDN"):(l=n.value.cdn_url,d="CDN");break}let _=document.querySelector(".temp-external-link");_||(_=document.createElement("textarea"),_.setAttribute("class","temp-external-link"),_.style.position="absolute",_.style.top="-99999rem",_.style.left="-99999rem",document.body.appendChild(_)),_.value=l,_.select(),document.execCommand("copy"),G.success(`${d} \u5916\u94FE\u590D\u5236\u6210\u529F\uFF01`)}return dn(()=>{n.value=t.imgObj}),se(()=>{n.value.is_transform_md=s.value.defaultMarkdown}),(a,l)=>{const d=ce;return p(),F("div",us,[r("div",null,[m(d,{content:n.value.is_transform_md?"\u70B9\u51FB\u8F6C\u6362\u666E\u901A\u5916\u94FE":"\u70B9\u51FB\u8F6C\u6362 Markdown \u683C\u5F0F\u5916\u94FE",placement:"top"},{default:f(()=>[r("div",{class:"markdown-icon-box flex-center",onClick:l[0]||(l[0]=c=>n.value.is_transform_md=!n.value.is_transform_md)},[n.value.is_transform_md?E("",!0):(p(),F("svg",ls,rs)),n.value.is_transform_md?(p(),F("svg",cs,_s)):E("",!0)])]),_:1},8,["content"])]),r("div",ps,[m(d,{content:"\u70B9\u51FB\u590D\u5236 GitHub \u5916\u94FE",placement:"top"},{default:f(()=>[r("span",{class:"btn-item copy-url github flex-center",onClick:l[1]||(l[1]=c=>u(i(o).gh))}," GitHub ")]),_:1}),m(d,{content:"\u70B9\u51FB\u590D\u5236 CDN \u5916\u94FE",placement:"top"},{default:f(()=>[r("span",{class:"btn-item copy-url cdn flex-center",onClick:l[2]||(l[2]=c=>u(i(o).cdn))}," CDN ")]),_:1})])])}}});var Xe=V(ms,[["__scopeId","data-v-a03989aa"]]);const fs={class:"image-box"},gs=["src"],hs={class:"info-box"},Es={class:"image-info"},vs={key:1,class:"filename"},Fs={class:"image-operation"},Ds={class:"operation-box"},Is={class:"operation-left"},Cs={class:"operation-right"},Ss={class:"operation-btn"},bs=L(" \u5220\u9664 "),As=L("\u91CD\u547D\u540D"),$s=L(" \u5C5E\u6027 "),ys=R({__name:"image-card",props:{listing:{type:Boolean,default:!1},imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1},index:{type:Number},modelValue:{type:Number}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,n=H(),o=_n(),u=A(()=>n.getters.getUserConfigInfo),a=A(()=>o.path==="/management"),l=T(),d=T(!1),c=T("");A(()=>n.getters.getToUploadImage).value;const _=T(!1),g=(I,U=!1)=>{U||(I.deleting=!0);const{owner:j,selectedRepos:Y}=u.value;return new Promise(Q=>{W.delete(`/repos/${j}/${Y}/contents/${I.path}`,{data:{owner:j,repo:Y,path:I.path,message:"Delete picture via PicX(https://github.com/XPoet/picx)",sha:I.sha}}).then(J=>{console.log("[deleteImage] ",J),J&&J.status===200?(I.deleting=!1,G.success(`${U?"\u66F4\u65B0":"\u5220\u9664"}\u6210\u529F\uFF01`),n.dispatch("UPLOADED_LIST_REMOVE",I.uuid),n.dispatch("DIR_IMAGE_LIST_REMOVE",I),Q(!0)):I.deleting=!1})})},D=I=>{ve.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${I.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{g(I)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},b=I=>{I.checked=!I.checked,n.commit("IMAGE_CARD",{imageObj:I})},O=async I=>{t("update:modelValue",s.index),c.value=De(I.name),await at(()=>{const U=setTimeout(()=>{var j;(j=l.value)==null||j.focus(),clearTimeout(U)},100)})},B=()=>{t("update:modelValue",void 0)},h=async()=>{B();const{imageObj:I}=s;if(c.value===De(I.name)||!c.value)return;const U=async()=>{const j=rt.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),Y=je(I.name),Q={name:c.value+I.name.substring(I.name.indexOf(".")),size:I.size,lastModified:Date.now(),type:`image/${Y}`},J=await ns(I.cdn_url,Y);if(J){const C=ss(J,Q);C&&await wt(u.value,C)&&(c.value="",await g(I,!0),await n.dispatch("UPLOADED_LIST_REMOVE",C.uuid))}j.close()};ve.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${c.value} \uFF1F`,"\u63D0\u793A",{type:"warning"}).then(async()=>{await U()}).catch(()=>{console.log("\u53D6\u6D88\u56FE\u7247\u91CD\u547D\u540D")})},k=I=>{_.value=I},$=I=>{ve.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${I.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${Oe(I.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(I,U)=>{const j=Ae,Y=X("Check"),Q=de,J=X("MoreFilled"),C=ut,v=lt,w=it,N=$e;return K((p(),F("div",{class:ue(["image-card",{listing:e.listing,checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:U[5]||(U[5]=z=>d.value=!0),onMouseleave:U[6]||(U[6]=z=>d.value=!1)},[r("div",fs,[r("img",{"data-fancybox":"gallery",src:e.imageObj.cdn_url},null,8,gs)]),r("div",hs,[r("div",Es,[c.value&&s.modelValue===s.index?(p(),S(j,{key:0,size:"small",class:"rename-input",modelValue:c.value,"onUpdate:modelValue":U[0]||(U[0]=z=>c.value=z),onBlur:B,onKeydown:pn(ie(h,["prevent"]),["enter"]),ref_key:"renameInputRef",ref:l},null,8,["modelValue","onKeydown"])):(p(),F("div",vs,M(e.imageObj.name),1)),r("div",Fs,[m(Xe,{"img-obj":e.imageObj},null,8,["img-obj"])])])]),K(r("div",Ds,[r("div",Is,[i(a)?(p(),F("div",{key:0,class:ue([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:U[1]||(U[1]=z=>b(e.imageObj))},[e.imageObj.checked?(p(),S(Q,{key:0},{default:f(()=>[m(Y)]),_:1})):E("",!0)],2)):E("",!0)]),r("div",Cs,[m(w,{size:"default",trigger:"click",onVisibleChange:k},{dropdown:f(()=>[m(v,null,{default:f(()=>[m(C,{onClick:U[2]||(U[2]=z=>D(e.imageObj))},{default:f(()=>[bs]),_:1}),m(C,{onClick:U[3]||(U[3]=ie(z=>O(e.imageObj),["self"]))},{default:f(()=>[As]),_:1}),m(C,{onClick:U[4]||(U[4]=z=>$(e.imageObj))},{default:f(()=>[$s]),_:1})]),_:1})]),default:f(()=>[r("div",Ss,[m(Q,null,{default:f(()=>[m(J)]),_:1})])]),_:1})])],512),[[Ee,d.value||_.value||e.imageObj.checked]])],34)),[[N,e.imageObj.deleting]])}}});var Ut=V(ys,[["__scopeId","data-v-567eb20e"]]);const ks={key:0,class:"selected-info-bar-box"},ws={class:"info-item"},Ls=L(" \u4ED3\u5E93\uFF1A "),Us={key:0,class:"info-item"},Bs=L(" \u5206\u652F\uFF1A "),Ts={key:1,class:"info-item"},Os=L(" \u76EE\u5F55\uFF1A "),Ms=R({__name:"selected-info-bar",setup(e){const t=H(),s=A(()=>t.getters.getUserConfigInfo);return A(()=>t.getters.getUserSettings),(n,o)=>{const u=ct;return i(s).selectedRepos?(p(),F("div",ks,[r("span",ws,[Ls,m(u,null,{default:f(()=>[L(M(i(s).selectedRepos),1)]),_:1})]),i(s).selectedBranch?(p(),F("span",Us,[Bs,m(u,null,{default:f(()=>[L(M(i(s).selectedBranch),1)]),_:1})])):E("",!0),i(s).selectedDir?(p(),F("span",Ts,[Os,m(u,null,{default:f(()=>[L(M(i(s).selectedDir),1)]),_:1})])):E("",!0)])):E("",!0)}}});var Ye=V(Ms,[["__scopeId","data-v-731257dc"]]),ee;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(ee||(ee={}));const Rs=R({name:"to-upload-image-card",components:{copyExternalLink:Xe,selectedInfoBar:Ye},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=H(),t=ye({isShowDialog:!1,curImgInfo:{size:""},userConfigInfo:A(()=>e.getters.getUserConfigInfo).value,userSettings:A(()=>e.getters.getUserSettings).value,toUploadImage:A(()=>e.getters.getToUploadImage).value,hashRename(n,o){n?o.filename.now=`${o.filename.name}.${o.filename.hash}.${o.filename.suffix}`:o.filename.now=`${o.filename.name}.${o.filename.suffix}`},prefixName(n,o){n?o.filename.name=`${o.filename.prefixName}${o.filename.initName}`:o.filename.name=`${o.filename.initName}`,o.filename.isHashRename?o.filename.now=`${o.filename.name}.${o.filename.hash}.${o.filename.suffix}`:o.filename.now=`${o.filename.name}.${o.filename.suffix}`},rename(n,o){n?o.filename.name=o.filename.newName.trim().replace(/\s+/g,"-"):t.prefixName(o.filename.isPrefix,o),o.filename.isHashRename?o.filename.now=`${o.filename.name}.${o.filename.hash}.${o.filename.suffix}`:o.filename.now=`${o.filename.name}.${o.filename.suffix}`},getFileSize(n){return`${Oe(n)} KB`},formatLastModified(n){return Be.formatTimestamp(n)},async uploadImage_all(n){const o=this.toUploadImage.uploadedNumber;return o>=this.toUploadImage.list.length?ee.uploaded:await wt(n,this.toUploadImage.list[o])?o<this.toUploadImage.list.length?(await this.uploadImage_all(n),ee.allUploaded):ee.uploaded:ee.uploadFail}}),s=n=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",n.uuid)};return se(()=>{const{defaultHash:n,defaultPrefix:o,prefixName:u}=t.userSettings;t.toUploadImage.list.forEach(a=>{a.filename.isPrefix=o,a.filename.prefixName=u,t.prefixName(o,a),a.filename.isHashRename=n,t.hashRename(n,a)})}),Ve(me({},ke(t)),{removeToUploadImage:s})}}),xs={key:0,class:"to-upload-image-list-card"},Ps={class:"header"},Vs={key:0},Ns={key:0,class:"body"},Gs={class:"image-uploading-info-box"},zs={class:"left-image-box flex-center"},Hs={class:"image-box"},js=["src"],Xs={class:"right-operation-box"},Ys={class:"top"},Js={class:"image-name"},Ks={class:"image-info"},qs={key:0,class:"file-size item"},Ws={class:"last-modified item"},Qs={key:0,class:"bottom rename-operation"},Zs={key:1,class:"bottom rename-operation"},eo=["onClick"];function to(e,t,s,n,o,u){const a=Ye,l=dt,d=Ae,c=Xe,_=X("Upload"),g=de,D=X("Loading"),b=X("Check"),O=X("Delete"),B=ce;return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(p(),F("div",xs,[r("div",Ps,[r("div",null,[m(a)]),r("div",null,[e.toUploadImage.list.length?(p(),F("span",Vs," \u5DF2\u4E0A\u4F20\uFF1A"+M(e.toUploadImage.uploadedNumber)+" / "+M(e.toUploadImage.list.length),1)):E("",!0)])]),e.toUploadImage.list.length?(p(),F("div",Ns,[r("ul",Gs,[(p(!0),F(ne,null,re(e.toUploadImage.list,(h,k)=>(p(),F("li",{class:ue(["image-uploading-info-item",{disable:e.loadingAllImage}]),key:k},[r("div",zs,[r("div",Hs,[r("img",{"data-fancybox":"gallery",src:h.imgData.base64Url},null,8,js)])]),r("div",Xs,[r("div",Ys,[r("div",Js,M(h.filename.now),1),r("div",Ks,[e.userSettings.isCompress?(p(),F("span",qs,[r("del",null,M(e.getFileSize(h.fileInfo.originSize)),1)])):E("",!0),r("span",{class:ue(["file-size item",{compressed:e.userSettings.isCompress}])},M(e.getFileSize(h.fileInfo.size)),3),r("span",Ws,M(e.formatLastModified(h.fileInfo.lastModified)),1)])]),!h.uploadStatus.uploading&&h.uploadStatus.progress!==100?(p(),F("div",Qs,[m(l,{label:"\u54C8\u5E0C\u5316",modelValue:h.filename.isHashRename,"onUpdate:modelValue":$=>h.filename.isHashRename=$,onChange:$=>e.hashRename($,h)},null,8,["modelValue","onUpdate:modelValue","onChange"]),m(l,{label:"\u91CD\u547D\u540D",modelValue:h.filename.isRename,"onUpdate:modelValue":$=>h.filename.isRename=$,onChange:$=>e.rename($,h)},null,8,["modelValue","onUpdate:modelValue","onChange"]),h.filename.isRename?(p(),S(d,{key:0,class:"rename-input",size:"mini",modelValue:h.filename.newName,"onUpdate:modelValue":$=>h.filename.newName=$,onInput:$=>e.rename($,h),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):E("",!0),!h.filename.isRename&&e.userConfigInfo.defaultPrefix&&e.userConfigInfo.prefixName?(p(),S(l,{key:1,label:"\u547D\u540D\u524D\u7F00",modelValue:h.filename.isPrefix,"onUpdate:modelValue":$=>h.filename.isPrefix=$,onChange:$=>e.prefixName($,h)},null,8,["modelValue","onUpdate:modelValue","onChange"])):E("",!0)])):E("",!0),!h.uploadStatus.uploading&&h.uploadStatus.progress===100?(p(),F("div",Zs,[m(c,{"img-obj":h.uploadedImg},null,8,["img-obj"])])):E("",!0)]),r("div",{class:ue(["upload-status-box",{"wait-upload":!h.uploadStatus.uploading&&h.uploadStatus.progress!==100,uploading:h.uploadStatus.uploading&&h.uploadStatus.progress!==100,uploaded:!h.uploadStatus.uploading&&h.uploadStatus.progress===100}])},[!h.uploadStatus.uploading&&h.uploadStatus.progress!==100?(p(),S(g,{key:0},{default:f(()=>[m(_)]),_:1})):E("",!0),h.uploadStatus.uploading&&h.uploadStatus.progress!==100?(p(),S(g,{key:1,class:"is-loading"},{default:f(()=>[m(D)]),_:1})):E("",!0),!h.uploadStatus.uploading&&h.uploadStatus.progress===100?(p(),S(g,{key:2},{default:f(()=>[m(b)]),_:1})):E("",!0)],2),h.uploadStatus.progress!==100&&!h.uploadStatus.uploading?(p(),F("div",{key:0,class:"remove-to-upload-image",onClick:$=>e.removeToUploadImage(h)},[m(B,{effect:"dark",content:"\u79FB\u9664",placement:"top"},{default:f(()=>[m(g,null,{default:f(()=>[m(O)]),_:1})]),_:1})],8,eo)):E("",!0)],2))),128))])])):E("",!0)])):E("",!0)}var no=V(Rs,[["render",to]]);const Je=async(e,t)=>{if(!e)return null;if(!At(e.type))return G.error("\u8BE5\u6587\u4EF6\u683C\u5F0F\u4E0D\u652F\u6301\uFF01"),null;let s;const{isCompress:n,compressEncoder:o}=x.getters.getUserSettings,u=e.type==="image/gif";if(!u&&n){const a=rt.service({target:".upload-area",text:"\u6B63\u5728\u538B\u7F29\u56FE\u7247"});s=await Gn(e,o),a.close()}return new Promise(a=>{const l=new FileReader;l.readAsDataURL(!u&&n?s:e),l.onload=d=>{var g;const c=(g=d.target)==null?void 0:g.result,_=Oe(c.length);_>=t?ve.confirm(`\u5F53\u524D\u56FE\u7247 ${(_/1024).toFixed(2)} M\uFF0CCDN \u53EA\u80FD\u52A0\u901F\u5C0F\u4E8E 50 MB \u7684\u56FE\u7247\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u7B2C\u4E09\u65B9\u5DE5\u5177 TinyPNG \u538B\u7F29`,"\u56FE\u7247\u8FC7\u5927\uFF0C\u7981\u6B62\u4E0A\u4F20",{confirmButtonText:"\u524D\u5F80 TinyPNG",cancelButtonText:"\u653E\u5F03\u4E0A\u4F20"}).then(()=>{window.open("https://tinypng.com/")}).catch(()=>{console.log("\u653E\u5F03\u4E0A\u4F20")}):a({base64:c,originalFile:e,compressFile:!u&&n?s:e})}})},so=(e,t)=>e.clipboardData&&e.clipboardData.items?new Promise(s=>{var n;for(let o=0,u=e.clipboardData.items.length;o<u;o++){const a=e.clipboardData.items[o];if(a.kind==="file"){const l=a.getAsFile();(n=Je(l,t))==null||n.then(d=>{if(!d)return;const{base64:c,originalFile:_,compressFile:g}=d;s({base64:c,originalFile:_,compressFile:g})})}}}):null;const oo=R({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=H(),t=ye({userConfigInfo:A(()=>e.getters.getUserConfigInfo).value,userSettings:A(()=>e.getters.getUserSettings).value,uploadAreaActive:A(()=>e.getters.getUploadAreaActive),uploadSettings:A(()=>e.getters.getUploadSettings).value,toUploadImage:A(()=>e.getters.getToUploadImage).value,onSelect(s){var n;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const o of s.target.files)(n=Je(o,this.uploadSettings.imageMaxSize))==null||n.then(u=>{if(!u)return;const{base64:a,originalFile:l,compressFile:d}=u;this.getImage(a,l,d)})},onDrop(s){var n;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const o of s.dataTransfer.files)(n=Je(o,this.uploadSettings.imageMaxSize))==null||n.then(u=>{if(!u)return;const{base64:a,originalFile:l,compressFile:d}=u;this.getImage(a,l,d)})},async onPaste(s){const{base64:n,originalFile:o,compressFile:u}=await so(s,this.uploadSettings.imageMaxSize);this.getImage(n,o,u)},getImage(s,n,o){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const{defaultHash:u,isCompress:a,defaultPrefix:l,prefixName:d}=this.userSettings,c=a?o:n,_=kt();_.imgData.base64Url=s,_.imgData.base64Content=s.split(",")[1];const{name:g,hash:D,suffix:b}=$t(c==null?void 0:c.name);_.uuid=D,_.fileInfo.compressedSize=o==null?void 0:o.size,_.fileInfo.originSize=n.size,_.fileInfo.size=c==null?void 0:c.size,_.fileInfo.lastModified=c==null?void 0:c.lastModified,_.filename.initName=g,_.filename.name=l?`${d}${g}`:g,_.filename.prefixName=d,_.filename.hash=D,_.filename.suffix=b,_.filename.now=u?`${_.filename.name}.${D}.${b}`:`${_.filename.name}.${b}`,_.filename.isHashRename=u,_.filename.isPrefix=l,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(_))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:D,base64Url:s})}});return me({},ke(t))}}),ao=e=>(oe("data-v-803bd60a"),e=e(),ae(),e),uo={key:0,for:"uploader",class:"active-upload"},lo={key:1,class:"tips active-upload"},io=ao(()=>r("div",{class:"text active-upload"},"\u62D6\u62FD\u3001\u7C98\u8D34\u3001\u6216\u70B9\u51FB\u6B64\u5904\u4E0A\u4F20",-1)),ro=["src"];function co(e,t,s,n,o,u){const a=X("UploadFilled"),l=de,d=$e;return K((p(),F("div",{class:ue(["upload-area active-upload",{focus:e.uploadAreaActive}]),onDragover:t[1]||(t[1]=ie(()=>{},["prevent"])),onDrop:t[2]||(t[2]=ie((...c)=>e.onDrop&&e.onDrop(...c),["stop","prevent"])),onPaste:t[3]||(t[3]=(...c)=>e.onPaste&&e.onPaste(...c)),"element-loading-text":"\u56FE\u7247\u4E0A\u4F20\u4E2D...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(p(),F("label",uo)):E("",!0),r("input",{id:"uploader",type:"file",onChange:t[0]||(t[0]=(...c)=>e.onSelect&&e.onSelect(...c)),multiple:"multiple"},null,32),e.toUploadImage.curImgBase64Url?E("",!0):(p(),F("div",lo,[m(l,{class:"icon active-upload"},{default:f(()=>[m(a)]),_:1}),io])),e.toUploadImage.curImgBase64Url?(p(),F("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,ro)):E("",!0)],34)),[[d,e.imageLoading]])}var _o=V(oo,[["render",co],["__scopeId","data-v-803bd60a"]]);const po={class:"upload-page-container"},mo={key:0,class:"upload-page-left page-container",style:{width:"280rem"}},fo={class:"upload-page-right page-container"},go={class:"row-item"},ho={class:"content-box"},Eo={class:"row-item"},vo={class:"content-box"},Fo={class:"row-item"},Do={class:"content-box",style:{"text-align":"right"}},Io=L("\u91CD\u7F6E "),Co=L(" \u4E0A\u4F20 "),So=R({__name:"upload",setup(e){const t=H(),s=he();T(null),T(null);const n=T(null),o=T(null),u=A(()=>t.getters.getUserConfigInfo),a=A(()=>t.getters.getUserSettings),l=A(()=>t.getters.getUserLoggingStatus),d=A(()=>t.getters.getUploadedImageList),c=A(()=>t.getters.getToUploadImage),_=T(!1),g=()=>{const{token:b,selectedRepos:O,selectedDir:B}=u.value;if(!b){G.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E\uFF01"),s.push("/config");return}if(!O){G.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),s.push("/config");return}if(!B){G.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),s.push("/config");return}if(c.value.list.length===0){G.error("\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}if(c.value.list.length===c.value.uploadedNumber){G.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247\uFF01");return}_.value=!0,n.value.uploadImage_all(u.value).then(h=>{switch(h){case ee.uploaded:case ee.allUploaded:_.value=!1,t.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case ee.uploadFail:_.value=!1,t.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL");break}}).catch(h=>{console.error("upload error: ",h),_.value=!1})},D=()=>{_.value=!1,t.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return Z(()=>l,b=>{!b&&D()}),(b,O)=>{const B=Ne;return p(),F("div",po,[i(d).length&&i(a).elementPlusSize==="large"?(p(),F("div",mo,[(p(!0),F(ne,null,re(i(d),(h,k)=>(p(),F("div",{class:"uploaded-item",key:k},[m(Ut,{"image-obj":h,"is-uploaded":!0},null,8,["image-obj"])]))),128))])):E("",!0),r("div",fo,[r("div",go,[r("div",ho,[m(_o,{"image-loading":_.value,ref_key:"uploadAreaDom",ref:o},null,8,["image-loading"])])]),r("div",Eo,[r("div",vo,[m(no,{ref_key:"toUploadImageCardDom",ref:n,"loading-all-image":_.value},null,8,["loading-all-image"])])]),r("div",Fo,[r("div",Do,[i(c).list.length?(p(),S(B,{key:0,plain:"",type:"warning",onClick:D},{default:f(()=>[Io]),_:1})):E("",!0),m(B,{plain:"",type:"primary",onClick:g},{default:f(()=>[Co]),_:1})])])])])}}});const Bt=e=>(oe("data-v-9b1f043c"),e=e(),ae(),e),bo=Bt(()=>r("div",{class:"icon"},[r("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[r("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),r("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),Ao={key:1,class:"icon"},$o=Bt(()=>r("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[r("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),yo=[$o],ko={key:2,class:"text"},wo={key:3,class:"text"},Lo=R({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,n=H(),o=A(()=>n.getters.getUserConfigInfo).value,u=()=>{const{folderObj:a,mode:l}=s;if(l==="back"){const c=o.selectedDir;if(c==="/")return;const _=c.split("/");_.length===1?o.selectedDir="/":_.length>1&&(_.length-=1,o.selectedDir=_.join("/"))}else o.selectedDir=a.dirPath;const{selectedDir:d}=o;d==="/"?(o.selectedDirList=[],o.dirMode="rootDir"):(o.selectedDirList=d.split("/"),o.dirMode="reposDir"),n.dispatch("USER_CONFIG_INFO_NOT_PERSIST")};return(a,l)=>{const d=ce;return p(),F("div",{class:"folder-card",onDblclick:u},[e.mode==="dir"?(p(),S(d,{key:0,effect:"dark",content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:f(()=>[bo]),_:1})):E("",!0),e.mode==="back"?(p(),F("div",Ao,yo)):E("",!0),e.mode==="dir"?(p(),F("div",ko,M(e.folderObj.dir),1)):E("",!0),e.mode==="back"?(p(),F("div",wo,"\u53CC\u51FB\u8FD4\u56DE")):E("",!0)],32)}}});var Tt=V(Lo,[["__scopeId","data-v-9b1f043c"]]);function Uo(e,t,s){let n="";const o=document.querySelector(".temp-batch-externalink");o.value="",(e==null?void 0:e.length)>0?(e.forEach((u,a)=>{const l=u.is_transform_md;switch(t){case P.gh:l?n=u.md_gh_url:n=u.github_url;break;case P.cdn:l?n=u.md_cdn_url:n=u.cdn_url;break}a<e.length-1?o.value+=n+`
`:o.value+=n}),o.select(),document.execCommand("copy"),G.success(`${s}`)):console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")}var pe;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(pe||(pe={}));let Ie=0;async function Bo(e,t){e.deleting=!0;const{owner:s,selectedRepos:n}=t;return new Promise((o,u)=>{W.delete(`/repos/${s}/${n}/contents/${e.path}`,{data:{owner:s,repo:n,path:e.path,message:"delete picture via PicX(https://github.com/XPoet/picx)",sha:e.sha}}).then(a=>{a&&a.status===200?(e.deleting=!1,x.dispatch("UPLOADED_LIST_REMOVE",e.uuid),x.dispatch("DIR_IMAGE_LIST_REMOVE",e),o(!0)):(e.deleting=!1,o(!1))}).catch(a=>{u(a)})})}async function Ot(e,t){return Ie>=e.length?pe.deleted:await Bo(e[Ie],t)?Ie<e.length&&(Ie+=1,await Ot(e,t))?(Ie=0,pe.allDeleted):pe.deleted:pe.deleteFail}const To=e=>(oe("data-v-fbfb45f2"),e=e(),ae(),e),Oo={key:0,class:"selector-wrapper"},Mo={class:"selector-left-box"},Ro={class:"item"},xo={class:"selector-right-box"},Po=To(()=>r("textarea",{class:"temp-batch-externalink"},null,-1)),Vo=R({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e,{emit:t}){const s=e,n=H(),o=T(!1),u=A(()=>n.getters.getImageCardCheckedArr),a=A(()=>n.getters.getUserConfigInfo).value,l=A(()=>u.value.length||0);Z(()=>l.value,D=>{const b=s.currentDirImageList.length;o.value=D===b});function d(){Uo(u.value,P.cdn,"\u6279\u91CF\u590D\u5236\u94FE\u63A5\u6210\u529F")}function c(){s.currentDirImageList.forEach(D=>{D.checked&&(D.checked=!1)})}async function _(){var D;((D=u.value)==null?void 0:D.length)>0?ve.confirm("\u662F\u5426\u6279\u91CF\u5220\u9664\u5DF2\u9009\u4E2D\u7684\u56FE\u7247\uFF1F","\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{await Ot(u.value,a)===pe.allDeleted&&G.success("\u6279\u91CF\u5220\u9664\u6210\u529F\uFF01")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):G.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")}function g(){let D=[];s.currentDirImageList.forEach(b=>{b.checked=o.value}),D=s.currentDirImageList,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:D})}return se(()=>{g()}),(D,b)=>{const O=dt,B=X("CopyDocument"),h=de,k=ce,$=X("Delete");return i(l)?(p(),F("div",Oo,[r("div",Mo,[m(O,{label:o.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=I=>o.value=I),onChange:g},null,8,["label","modelValue"]),r("div",Ro,"\u5DF2\u9009\u62E9 "+M(i(l))+" \u5F20\u56FE\u7247",1),r("div",{class:"item cancel-select-btn",onClick:c},"\u53D6\u6D88\u9009\u62E9")]),r("div",xo,[m(k,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u5916\u94FE"},{default:f(()=>[m(h,{class:"btn-icon",onClick:d},{default:f(()=>[m(B)]),_:1})]),_:1}),m(k,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:f(()=>[m(h,{class:"btn-icon",onClick:_},{default:f(()=>[m($)]),_:1})]),_:1})]),Po])):E("",!0)}}});var No=V(Vo,[["__scopeId","data-v-fbfb45f2"]]);const Go=e=>(oe("data-v-51ab8f2c"),e=e(),ae(),e),zo={class:"page-container management-page-container"},Ho={class:"content-container"},jo={class:"top"},Xo={class:"left"},Yo={class:"right flex-start"},Jo={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},Ko={key:0,class:"image-item"},qo=Go(()=>r("div",{class:"clear"},null,-1)),Wo=R({__name:"management",setup(e){const t=H(),s=he(),n=A(()=>t.getters.getUserConfigInfo).value,o=A(()=>t.getters.getUserLoggingStatus).value,u=A(()=>t.getters.getDirObject).value,a=T(new Date().getTime()),l=T(!1),d=T(!1),c=T(),_=T([]),g=T([]);async function D(k){l.value=!0;const $=Le(k,u);if($){const I=Ue(k,$,"dir"),U=Ue(k,$,"image");!I.length&&!U.length?await Re(k):(_.value=I,g.value=U,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:g.value}))}else await Re(k);l.value=!1}async function b(){const{selectedDir:k,dirMode:$}=n;if(($==="newDir"||$==="autoDir")&&!Le(k,u)&&(n.selectedDir="/",n.dirMode="rootDir"),!u.imageList.length&&!u.childrenDirs.length){await Re(n.selectedDir);return}await D(n.selectedDir)}function O(){d.value=!d.value}async function B(){const{selectedDir:k}=n;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",k),l.value=!0,await Re(k),l.value=!1}se(()=>{b()}),Z(()=>o,k=>{k===!1&&s.push("/config")}),Z(()=>n.selectedDir,async k=>{wn(k,t),await D(k),a.value+=1},{deep:!0}),Z(()=>u,k=>{const{selectedDir:$}=n,I=Le($,k);I&&(_.value=Ue($,I,"dir"),g.value=Ue($,I,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:g.value}))},{deep:!0});const h=T(!1);return Z(()=>g.value,k=>{h.value=k.filter($=>$.checked).length>0},{deep:!0}),(k,$)=>{const I=X("Tickets"),U=X("Menu"),j=de,Y=ce,Q=X("Refresh"),J=$e;return p(),F("div",zo,[r("div",Ho,[r("div",jo,[r("div",Xo,[m(Ye)]),r("div",Yo,[m(Y,{placement:"top",content:d.value?"\u5207\u6362\u65B9\u5757\u5C55\u793A":"\u5207\u6362\u5217\u8868\u5C55\u793A"},{default:f(()=>[m(j,{class:"btn-icon",onClick:ie(O,["stop"])},{default:f(()=>[d.value?(p(),S(I,{key:0})):E("",!0),d.value?E("",!0):(p(),S(U,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"]),m(Y,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D\u56FE\u7247"},{default:f(()=>[m(j,{class:"btn-icon",onClick:ie(B,["stop"])},{default:f(()=>[m(Q)]),_:1},8,["onClick"])]),_:1})])]),K((p(),F("div",Jo,[g.value.length?(p(),S(No,{currentDirImageList:g.value,"onUpdate:initImageList":g.value,key:a.value},null,8,["currentDirImageList","onUpdate:initImageList"])):E("",!0),r("ul",{class:"image-list",style:_t({height:h.value?"calc(100% - 50rem)":"100%"})},[i(n).selectedDir!=="/"?(p(),F("li",Ko,[m(Tt,{mode:"back"})])):E("",!0),(p(!0),F(ne,null,re(_.value,(C,v)=>(p(),F("li",{class:"image-item",key:v},[m(Tt,{"folder-obj":C},null,8,["folder-obj"])]))),128)),qo,(p(!0),F(ne,null,re(g.value,(C,v)=>(p(),F("li",{class:"image-item",key:v,style:_t({width:d.value?"50%":"230rem",height:d.value?"80rem":"240rem"})},[m(Ut,{"image-obj":C,listing:d.value,modelValue:c.value,"onUpdate:modelValue":$[0]||($[0]=w=>c.value=w),index:v},null,8,["image-obj","listing","modelValue","index"])],4))),128))],4)])),[[J,l.value]])])])}}});var Qo=V(Wo,[["__scopeId","data-v-51ab8f2c"]]);const Zo={},ea={class:"tutorials-step-3"},ta=mn('<h3>\u8FDB\u884C\u56FE\u5E8A\u914D\u7F6E\uFF08\u7ED1\u5B9A GitHub Token\u3001\u5B58\u50A8\u56FE\u7247\u7684\u4ED3\u5E93\u548C\u76EE\u5F55\uFF09</h3><p>1\u3001\u586B\u5199 Token\uFF0C\u81EA\u52A8\u83B7\u53D6\u8BE5\u7528\u6237\u4E0B\u7684\u4ED3\u5E93</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2\u3001\u5728\u4ED3\u5E93\u7684\u4E0B\u62C9\u5217\u8868\u4E2D\uFF0C\u9009\u62E9\u4E00\u4E2A\u4F5C\u4E3A\u56FE\u5E8A\u7684\u4ED3\u5E93</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3\u3001\u9009\u62E9\u4E00\u79CD\u76EE\u5F55\u65B9\u5F0F\uFF08\u76EE\u5F55\u5373\u4ED3\u5E93\u91CC\u5B58\u653E\u56FE\u7247\u7684\u6587\u4EF6\u5939\uFF09</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>\u65B0\u5EFA\u76EE\u5F55\uFF1A\u9700\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\u3002</li><li>\u6839\u76EE\u5F55\uFF1A\u56FE\u7247\u5C06\u76F4\u63A5\u5B58\u50A8\u5728\u4ED3\u5E93\u6839\u76EE\u5F55\u4E0B\u3002</li><li>\u81EA\u52A8\u76EE\u5F55\uFF1A\u81EA\u52A8\u751F\u6210\u65E5\u671F\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55\u3002\u4F8B\u5982\uFF1A20200909</li><li>\u9009\u62E9\u4ED3\u5E93\u76EE\u5F55\uFF1A\u81EA\u52A8\u83B7\u53D6\u4ED3\u5E93\u4E0B\u6240\u6709\u76EE\u5F55\uFF0C\u9009\u62E9\u4E00\u4E2A\u5373\u53EF\u3002</li></ul></div>',10),na=[ta];function sa(e,t){return p(),F("div",ea,na)}var Mt=V(Zo,[["render",sa]]);const oa={class:"tutorials-step-2"},aa=L(" \u521B\u5EFA\u4E00\u4E2A\u6709 repo \u6743\u9650\u7684 "),ua=r("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),la=r("p",null,"\u7136\u540E\u70B9\u51FB Generate token \u6309\u94AE\uFF0C\u5373\u53EF\u751F\u6210\u4E00\u4E2Atoken\uFF0C\u5982\u4E0B\u56FE\uFF1A",-1),ia=r("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),ra=r("p",{style:{color:"red"}},[r("em",null,"\u65B0\u751F\u6210\u7684 Token \u53EA\u4F1A\u663E\u793A\u4E00\u6B21\uFF0C\u8BF7\u59A5\u5584\u4FDD\u5B58\uFF01\u5982\u6709\u9057\u5931\uFF0C\u91CD\u65B0\u751F\u6210\u5373\u53EF\u3002")],-1),Rt=R({__name:"step2",setup(e){function t(){window.open("https://github.com/settings/tokens/new")}return(s,n)=>(p(),F("div",oa,[r("h3",null,[aa,r("span",{class:"go-create-token",onClick:t}," GitHub Token")]),ua,la,ia,ra]))}});const ca={class:"tutorials-step-1"},da=L(" \u521B\u5EFA\u4E00\u4E2A\u7528\u6765\u5B58\u50A8\u56FE\u7247\u7684 "),_a=r("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1),xt=R({__name:"step1",setup(e){function t(){window.open("https://github.com/new")}return(s,n)=>(p(),F("div",ca,[r("h3",null,[da,r("span",{class:"go-create-repo",onClick:t}," GitHub \u4ED3\u5E93")]),_a]))}});const pa=R({name:"tutorials",components:{Step1:xt,Step2:Rt,Step3:Mt},setup(){const e=T(0);return{stepNum:e,step:s=>{s==="prev"&&(e.value<0?e.value=0:e.value-=1),s==="next"&&(e.value>3?e.value=3:e.value+=1)}}}}),Pt=e=>(oe("data-v-0275023f"),e=e(),ae(),e),ma={class:"page-container tutorials-page-container"},fa={class:"step-content"},ga={key:3},ha=Pt(()=>r("h2",null,"\u{1F44D} \u606D\u559C\u4F60\u5B8C\u6210\u56FE\u5E8A\u4F7F\u7528\u6559\u7A0B \u{1F31F} \u5FEB\u53BB\u8BD5\u8BD5\u5427~",-1)),Ea=Pt(()=>r("h2",null,"https://github.com/XPoet/picx",-1)),va=[ha,Ea],Fa={class:"btn-next-prev"},Da=L("\u4E0A\u4E00\u6B65 "),Ia=L("\u4E0B\u4E00\u6B65 ");function Ca(e,t,s,n,o,u){const a=fn,l=gn,d=xt,c=Rt,_=Mt,g=Ne;return p(),F("div",ma,[m(l,{active:e.stepNum,"finish-status":"success","align-center":""},{default:f(()=>[m(a,{title:"\u521B\u5EFA GitHub \u4ED3\u5E93"}),m(a,{title:"\u83B7\u53D6 GitHub Token"}),m(a,{title:"\u914D\u7F6E\u56FE\u5E8A"})]),_:1},8,["active"]),r("div",fa,[e.stepNum===0?(p(),S(d,{key:0})):E("",!0),e.stepNum===1?(p(),S(c,{key:1})):E("",!0),e.stepNum===2?(p(),S(_,{key:2})):E("",!0),e.stepNum===3?(p(),F("div",ga,va)):E("",!0)]),r("div",Fa,[e.stepNum>0?(p(),S(g,{key:0,type:"primary",onClick:t[0]||(t[0]=D=>e.step("prev"))},{default:f(()=>[Da]),_:1})):E("",!0),e.stepNum<3?(p(),S(g,{key:1,type:"primary",onClick:t[1]||(t[1]=D=>e.step("next"))},{default:f(()=>[Ia]),_:1})):E("",!0)])])}var Sa=V(pa,[["render",Ca],["__scopeId","data-v-0275023f"]]);const Ce=e=>(oe("data-v-1fc85350"),e=e(),ae(),e),ba={class:"page-container settings-page-container"},Aa=Ce(()=>r("div",{class:"setting-title"},"\u4E2A\u6027\u8BBE\u7F6E\uFF1A",-1)),$a={class:"setting-list"},ya={class:"setting-item"},ka={class:"setting-item"},wa={class:"setting-item"},La=Ce(()=>r("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),Ua={class:"setting-list"},Ba={class:"setting-item"},Ta={class:"setting-item"},Oa=Ce(()=>r("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u50CF\u7F16\u7801\u5668\uFF08\u538B\u7F29\u7B97\u6CD5\uFF09\uFF1A",-1)),Ma=Ce(()=>r("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),Ra={class:"setting-list"},xa={class:"setting-item"},Pa={key:0,class:"setting-title"},Va={key:1,class:"setting-list"},Na={class:"setting-item"},Ga=Ce(()=>r("span",{class:"time-middle-space"}," ~ ",-1)),za=R({__name:"settings",setup(e){const t=A(()=>x.getters.getUserSettings).value,s=()=>{x.dispatch("USER_SETTINGS_PERSIST")},n=Te,o=()=>{x.dispatch("SET_USER_SETTINGS",me({},t)),s()};return(u,a)=>{const l=hn,d=Ae,c=st,_=ot,g=tt,D=nt,b=En,O=Ze,B=et;return p(),F("div",ba,[Aa,r("ul",$a,[r("li",ya,[m(l,{modelValue:i(t).defaultHash,"onUpdate:modelValue":a[0]||(a[0]=h=>i(t).defaultHash=h),onChange:s,"active-text":"\u4E0A\u4F20\u65F6\u9ED8\u8BA4\u7ED9\u56FE\u7247\u52A0\u4E0A\u54C8\u5E0C\u7801"},null,8,["modelValue"])]),r("li",ka,[m(l,{modelValue:i(t).defaultMarkdown,"onUpdate:modelValue":a[1]||(a[1]=h=>i(t).defaultMarkdown=h),onChange:s,"active-text":"\u4E0A\u4F20\u540E\u9ED8\u8BA4\u5F00\u542F Markdown \u683C\u5F0F\u7684\u5916\u94FE"},null,8,["modelValue"])]),r("li",wa,[m(l,{modelValue:i(t).defaultPrefix,"onUpdate:modelValue":a[2]||(a[2]=h=>i(t).defaultPrefix=h),onChange:s,"active-text":"\u4E0A\u4F20\u65F6\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u7684\u547D\u540D\u524D\u7F00"},null,8,["modelValue"]),i(t).defaultPrefix?(p(),S(d,{key:0,class:"prefix-input",modelValue:i(t).prefixName,"onUpdate:modelValue":a[3]||(a[3]=h=>i(t).prefixName=h),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:s,clearable:"",autofocus:""},null,8,["modelValue"])):E("",!0)])]),La,r("ul",Ua,[r("li",Ba,[m(l,{modelValue:i(t).isCompress,"onUpdate:modelValue":a[4]||(a[4]=h=>i(t).isCompress=h),onChange:s,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"])]),r("li",Ta,[Oa,m(_,{disabled:!i(t).isCompress,modelValue:i(t).compressEncoder,"onUpdate:modelValue":a[5]||(a[5]=h=>i(t).compressEncoder=h),onChange:s},{default:f(()=>[m(c,{label:i(n).webP},{default:f(()=>[L(M(i(n).webP)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u5927\u591A\u6570\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301\uFF09 ",1)]),_:1},8,["label"]),m(c,{label:i(n).mozJPEG},{default:f(()=>[L(M(i(n).mozJPEG)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF09 ",1)]),_:1},8,["label"]),m(c,{label:i(n).avif},{default:f(()=>[L(M(i(n).avif)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u6BD4\u6700\u9AD8\uFF0C\u76EE\u524D\u4EC5\u8C37\u6B4C\u6D4F\u89C8\u5668\u652F\u6301\uFF09 ",1)]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])])]),Ma,r("ul",Ra,[r("li",xa,[m(D,{modelValue:i(t).themeMode,"onUpdate:modelValue":a[6]||(a[6]=h=>i(t).themeMode=h),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:o},{default:f(()=>[m(g,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:"auto"}),m(g,{label:"\u6697\u591C\u4E3B\u9898",value:"dark"}),m(g,{label:"\u767D\u663C\u4E3B\u9898",value:"light"})]),_:1},8,["modelValue"])])]),i(t).themeMode==="auto"?(p(),F("div",Pa," \u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A ")):E("",!0),i(t).themeMode==="auto"?(p(),F("ul",Va,[r("li",Na,[m(B,{ref:"form"},{default:f(()=>[m(O,null,{default:f(()=>[m(b,{modelValue:i(t).autoLightThemeTime[0],"onUpdate:modelValue":a[7]||(a[7]=h=>i(t).autoLightThemeTime[0]=h),placeholder:"",start:"00:00",step:"00:30",end:"23:59",onChange:o},null,8,["modelValue"]),Ga,m(b,{modelValue:i(t).autoLightThemeTime[1],"onUpdate:modelValue":a[8]||(a[8]=h=>i(t).autoLightThemeTime[1]=h),placeholder:"Start time",start:i(t).autoLightThemeTime[0],step:"00:30",end:"23:59",onChange:o},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):E("",!0)])}}});var Ha=V(za,[["__scopeId","data-v-1fc85350"]]);const ge=" | PicX \u56FE\u5E8A\u795E\u5668",ja=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:ts,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${ge}`}},{path:"/upload",name:"upload",component:So,meta:{title:`\u56FE\u7247\u4E0A\u4F20${ge}`}},{path:"/management",name:"Management",component:Qo,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${ge}`}},{path:"/tutorials",name:"tutorials",component:Sa,meta:{title:`\u4F7F\u7528\u6559\u7A0B${ge}`}},{path:"/about",name:"about",component:()=>ft(()=>import("./about.21bed656.js"),["assets/about.21bed656.js","assets/about.b13329a7.css","assets/vendor.3629949c.js","assets/vendor.b4775e2f.css"]),meta:{title:`\u5E2E\u52A9\u53CD\u9988${ge}`}},{path:"/settings",name:"settings",component:Ha,meta:{title:`\u6211\u7684\u8BBE\u7F6E${ge}`}}],Vt=vn({history:Fn(),routes:ja});Vt.beforeEach((e,t,s)=>{e.meta.title&&(window.document.title=e.meta.title),t.path==="/management"&&x.dispatch("USER_CONFIG_INFO_RESET"),s()});const Xa={key:0,class:"image-box"},Ya=["src"],Ja={key:0,class:"image-info"},Ka=R({__name:"image-viewer",setup(e){const t=H(),s=A(()=>t.getters.getImageViewer);function n(u){return`${Oe(u)} KB`}function o(u){return Be.formatTimestamp(u)}return(u,a)=>{var d,c,_,g;const l=ct;return p(),F("div",{class:ue(["image-viewer",{active:i(s).isShow}]),onClick:a[0]||(a[0]=D=>i(s).isShow=!1)},[((c=(d=i(s))==null?void 0:d.imgInfo)==null?void 0:c.url)?(p(),F("div",Xa,[r("img",{class:"img",src:(g=(_=i(s))==null?void 0:_.imgInfo)==null?void 0:g.url},null,8,Ya),i(s).imgInfo?(p(),F("div",Ja,[i(s).imgInfo.name?(p(),S(l,{key:0,class:"item",size:"small"},{default:f(()=>[L(" \u56FE\u7247\u540D\uFF1A"+M(i(s).imgInfo.name),1)]),_:1})):E("",!0),i(s).imgInfo.size?(p(),S(l,{key:1,class:"item",size:"small"},{default:f(()=>[L(" \u56FE\u7247\u5927\u5C0F\uFF1A"+M(n(i(s).imgInfo.size)),1)]),_:1})):E("",!0),i(s).imgInfo.lastModified?(p(),S(l,{key:2,class:"item",size:"small"},{default:f(()=>[L(" \u6700\u540E\u4FEE\u6539\u65F6\u95F4\uFF1A"+M(o(i(s).imgInfo.lastModified)),1)]),_:1})):E("",!0)])):E("",!0)])):E("",!0)],2)}}});var Nt=V(Ka,[["__scopeId","data-v-c1944e44"]]);const qa={class:"nav"},Wa={class:"nav-list"},Qa=["onClick"],Za={class:"nav-content"},eu={class:"nav-name"},tu=R({__name:"nav-content",setup(e){const t=he(),s=H(),n=A(()=>s.getters.getUserConfigInfo).value,o=A(()=>s.getters.getUserSettings).value,u=A(()=>{switch(o.elementPlusSize){case"small":return 22;case"large":return 30;default:return 26}}),a=T([{name:"\u56FE\u5E8A\u914D\u7F6E",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"\u4E0A\u4F20\u56FE\u7247",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"\u56FE\u5E8A\u7BA1\u7406",icon:"box",isActive:!1,path:"/management",isShow:!0},{name:"\u6211\u7684\u8BBE\u7F6E",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"\u4F7F\u7528\u6559\u7A0B",icon:"magic-stick",isActive:!1,path:"/tutorials",isShow:!0},{name:"\u5E2E\u52A9\u53CD\u9988",icon:"chat-dot-round",isActive:!1,path:"/about",isShow:!0}]),l=c=>{const{path:_}=c;if(_==="/management"){if(n.selectedRepos===""){G.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),t.push("/config");return}if(n.selectedDir===""){G.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),t.push("/config");return}}t.push(_)},d=c=>{a.value.forEach(_=>{const g=_;return g.isActive=_.path===c,g})};return Z(()=>t.currentRoute.value,c=>{d(c.path)}),Z(()=>n.loggingStatus,c=>{a.value.forEach(_=>{switch(_.path){case"/management":case"/settings":_.isShow=c}})},{deep:!0,immediate:!0}),se(()=>{t.isReady().then(()=>{d(t.currentRoute.value.path)})}),(c,_)=>{const g=de;return p(),F("aside",qa,[r("ul",Wa,[(p(!0),F(ne,null,re(a.value,(D,b)=>K((p(),F("li",{class:ue(["nav-item flex-center",{active:D.isActive}]),key:b,onClick:O=>l(D)},[r("div",Za,[m(g,{size:i(u)},{default:f(()=>[(p(),S(Dn(D.icon)))]),_:2},1032,["size"]),r("span",eu,M(D.name),1)])],10,Qa)),[[Ee,D.isShow]])),128))])])}}});var Gt=V(tu,[["__scopeId","data-v-51cd08a9"]]);const nu=R({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e,t){const s=T(null),n=T(!1),o=(u,a)=>u.querySelector(`.${a?"u":"p"}v`).innerText;return se(()=>{const u=document.createElement("script");u.async=!0,u.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",s.value.appendChild(u),u.onload=()=>{const a=setTimeout(()=>{o(s.value,e.isuv)&&(n.value=!0),clearTimeout(a)},1500)}}),{siteCountDom:s,isShow:n}}}),su={class:"site-count",ref:"siteCountDom"},ou=L(" \u8D85\u8FC7 "),au={id:"busuanzi_value_site_uv",class:"uv"},uu={id:"busuanzi_value_site_pv",class:"pv"},lu=L(" \u6B21\u88AB\u4F7F\u7528 ");function iu(e,t,s,n,o,u){return K((p(),F("span",su,[ou,K(r("span",au,null,512),[[Ee,e.isuv]]),K(r("span",uu,null,512),[[Ee,!e.isuv]]),lu],512)),[[Ee,e.isShow]])}var zt=V(nu,[["render",iu]]),ru="./assets/logo.206d082d.png";const cu=R({name:"header-content",components:{siteCount:zt},setup(){const e=he(),t=H(),s=ye({defaultUsername:"\u672A\u767B\u5F55",userConfigInfo:A(()=>t.state.userConfigInfoModule.userConfigInfo)}),n=()=>{!s.userConfigInfo.loggingStatus&&e.currentRoute.value.path!=="/config"&&e.push("/config")},o=()=>{t.dispatch("LOGOUT"),e.push("/config")},u=l=>{switch(l){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":o();break}},a=()=>{window.open("https://github.com/XPoet/picx")};return Ve(me({},ke(s)),{router:e,onUserInfoClick:n,handleCommand:u,goGitHubRepo:a})}}),Ht=e=>(oe("data-v-23f79e85"),e=e(),ae(),e),du={class:"header"},_u={class:"header-left"},pu=Ht(()=>r("div",{class:"logo"},[r("img",{src:ru,alt:"PicX"})],-1)),mu=Ht(()=>r("div",{class:"title"},"PicX",-1)),fu=[pu,mu],gu={class:"header-right"},hu={class:"username"},Eu={key:0,class:"avatar"},vu={class:"el-dropdown-link"},Fu={class:"avatar"},Du=["src","alt"],Iu=L(" \u9000\u51FA\u767B\u5F55 ");function Cu(e,t,s,n,o,u){var b,O;const a=zt,l=ce,d=X("UserFilled"),c=de,_=ut,g=lt,D=it;return p(),F("header",du,[r("div",_u,[r("div",{class:"brand",onClick:t[0]||(t[0]=B=>e.router.push("/"))},fu),r("div",{class:"website-count",onClick:t[1]||(t[1]=(...B)=>e.goGitHubRepo&&e.goGitHubRepo(...B))},[m(l,{content:"\u611F\u89C9\u597D\u7528\uFF0C\u70B9 Star \u652F\u6301\u4F5C\u8005(*\uFFE3\uFE36\uFFE3)",placement:"bottom"},{default:f(()=>[m(a,{isuv:!1})]),_:1})])]),r("div",gu,[r("div",{class:"user-info",onClick:t[2]||(t[2]=(...B)=>e.onUserInfoClick&&e.onUserInfoClick(...B))},[r("div",hu,M(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),((b=e.userConfigInfo)==null?void 0:b.avatarUrl)?E("",!0):(p(),F("div",Eu,[m(c,{size:22},{default:f(()=>[m(d)]),_:1})])),((O=e.userConfigInfo)==null?void 0:O.avatarUrl)?(p(),S(D,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:f(()=>[m(g,null,{default:f(()=>[m(_,{command:"logout"},{default:f(()=>[Iu]),_:1})]),_:1})]),default:f(()=>{var B,h;return[r("span",vu,[r("span",Fu,[r("img",{src:(B=e.userConfigInfo)==null?void 0:B.avatarUrl,alt:(h=e.userConfigInfo)==null?void 0:h.owner},null,8,Du)])])]}),_:1},8,["onCommand"])):E("",!0)])])])}var jt=V(cu,[["render",Cu],["__scopeId","data-v-23f79e85"]]);const Xt=()=>{const e=H(),t=async o=>{await at(()=>{const u=document.getElementsByTagName("html")[0];o==="dark"?(u.classList.remove("light"),u.classList.add("dark")):(u.classList.remove("dark"),u.classList.add("light"))})},s=o=>{const u=l=>{const d=new Date,c=d.getFullYear(),_=d.getMonth()+1,g=d.getDate();return new Date(`${c}/${_}/${g} ${o[l]}:00`).getTime()},a=Date.now();return u(0)<=a&&a<=u(1)},n=o=>{const{themeMode:u,autoLightThemeTime:a}=o;t(u==="auto"?s(a)?"light":"dark":u)};Z(()=>e.getters.getUserSettings,o=>{n(o)},{deep:!0,immediate:!0})};const Su=R({name:"main-container",components:{headerContent:jt,navContent:Gt,imageViewer:Nt},setup(){const e=H(),t=s=>{e.commit("CHANGE_UPLOAD_AREA_ACTIVE",s.target.classList.contains("active-upload"))};return se(()=>{Xt()}),{changeUploadAreaActive:t}}}),bu={class:"top"},Au={class:"bottom"},$u={class:"container"},yu={class:"left"},ku={class:"right"},wu={class:"content"};function Lu(e,t,s,n,o,u){const a=jt,l=Gt,d=X("router-view"),c=Nt;return p(),F(ne,null,[r("main",{class:"main-container",onClick:t[0]||(t[0]=(..._)=>e.changeUploadAreaActive&&e.changeUploadAreaActive(..._))},[r("div",bu,[m(a)]),r("div",Au,[r("div",$u,[r("div",yu,[m(l)]),r("div",ku,[r("div",wu,[m(d)])])])])]),m(c)],64)}var Yt=V(Su,[["render",Lu],["__scopeId","data-v-e30b4c00"]]);const Uu=R({name:"App",components:{ElConfigProvider:pt,mainContainer:Yt},setup(){const e=H(),t=ye({zIndex:3e3,size:"small",locale:In}),s=n=>{n<=600?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"small"}),t.size="small"):n<=800?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"default"}),t.size="default"):(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"large"}),t.size="large")};return se(()=>{Xt(),s(window.innerWidth),window.addEventListener("resize",n=>{s(n.target.innerWidth)})}),me({},ke(t))}});function Bu(e,t,s,n,o,u){const a=Yt,l=pt;return p(),S(l,{size:e.size,"z-index":e.zIndex,locale:e.locale},{default:f(()=>[m(a)]),_:1},8,["size","z-index","locale"])}var Tu=V(Uu,[["render",Bu]]);ft(()=>import("./register-sw.cd6affb8.js"),[]);const Jt=Cn(Tu);for(const[e,t]of Object.entries(Sn))Jt.component(e,t);Jt.use(Vt).use(x,bt).mount("#app");export{V as _};
